<div class="channel-container" *ngIf="user">
    <div class="channel-header">
        <div class="user" (click)="openUserProfil(user)">
            <div class="avatar-container">
                <img class="user-avatar" [src]="getAvatarForUser(user.name)" alt="">
                <div [ngClass]="{'offline-point': !user.online}" class="online-point"></div>
            </div>
            <span class="header1">{{ user.name }}
                @if (user.name === currentUser?.name) {
                    (Du)
                }
            </span>
        </div>
    </div>
    <div class="channel-content" #chatContainer>

        <!-- Gruppierte Nachrichten anzeigen -->
        <div *ngFor="let group of chatService.groupedMessages | keyvalue; let i = index">
            <div style="position: relative;">
                <hr class="separator-line">
                <button class="day-time-btn">{{ isToday(group.value[0].timestamp) ? 'Heute' :
                    group.value[0].dayDateMonth }}</button>
            </div>

            <div *ngIf="!chatService.chatIsEmpty">
                <div *ngFor="let message of group.value; let j = index">
                    <!-- Nachricht des anderen Benutzers -->
                    <div *ngIf="message.senderId == user.userId && user.userId !== currentUser.userId">
                        <table class="chat-table">
                            <tr>
                                <td>
                                    <div class="message-main">
                                        @if (userService.isNumber(user.avatar)) {
                                        <img class="avatar" src="\assets\avatars\avatar_{{user.avatar}}.png" alt="">
                                        } @else {
                                        <img class="avatar" src={{user.avatar}} alt="">
                                        }
                                        <div class="message-content">
                                            <div class="name-time"> {{ user.name }}
                                                <p class="time">{{ message.time }} Uhr</p>
                                            </div>
                                            <div class="speech-bubble">
                                                <span>{{ message.text }}</span>
                                                <div *ngIf="message.fileName" class="file-container">
                                                    <span>{{message.fileName}}</span>
                                                    <img *ngIf="message.fileType == 'image/jpeg' || message.fileType == 'image/png'" class="preview-img" [src]="message.fileDownloadUrl" alt="">

                                                    <object *ngIf="message.fileType == 'application/pdf'" [data]="message.safeUrl" type="application/pdf" width="60%" height="100%">
                                                        Dein Browser unterstützt keine PDF-Anzeige
                                                    </object>

                                                    <pre *ngIf="message.fileType == 'text/plain'" style="overflow: auto;"> <p>{{this.chatService.textContent}}</p></pre>
                                                    <button  class="open-file-button"
                                                        (click)="downloadFile(message.fileDownloadUrl, message.fileName)">Anhang
                                                        öffnen</button>
                                                </div>
                                            </div>

                                            <div class="reaction-container">
                                                <div *ngIf="message.reactionNerd && message.reactionNerd.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionNerd')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionNerd')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _nerd face_.png" alt="">
                                                        <span>{{message.reactionNerd.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble" 
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionNerd'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionNerd') 
                                                      }">
                                                            <img src="./assets/icons/emoji _nerd face_.png" alt="">
                                                            @for (user of message.reactionNerd; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionNerd.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionNerd.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionNerd.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionNerd.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <div *ngIf="message.reactionCelebrate && message.reactionCelebrate.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionCelebrate')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionCelebrate')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _person raising both hands in celebration_.png" alt="">
                                                        <span>{{message.reactionCelebrate.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble" 
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionCelebrate'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionCelebrate') 
                                                      }">
                                                            <img src="./assets/icons/emoji _person raising both hands in celebration_.png" alt="">
                                                            
                                                            @for (user of message.reactionCelebrate; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionCelebrate.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionCelebrate.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionCelebrate.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionCelebrate.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <div *ngIf="message.reactionCheck && message.reactionCheck.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionCheck')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionCheck')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _white heavy check mark_.png" alt="">
                                                        <span>{{message.reactionCheck.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble"                                                   
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionCheck'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionCheck') 
                                                      }">
                                                            <img src="./assets/icons/emoji _person raising both hands in celebration_.png" alt="">
                                                            
                                                            @for (user of message.reactionCheck; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionCheck.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionCheck.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionCheck.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionCheck.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <div *ngIf="message.reactionRocket && message.reactionRocket.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionRocket')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionRocket')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _rocket_.png" alt="">
                                                        <span>{{message.reactionRocket.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble"                                                         
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionRocket'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionRocket') 
                                                      }">
                                                            <img src="./assets/icons/emoji _rocket_.png" alt="">
                                                            
                                                            @for (user of message.reactionRocket; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionRocket.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionRocket.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionRocket.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionRocket.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <button class="add-reaction-button">
                                                    <img src="./assets/icons/add_reaction.png" alt="">
                                                </button>
                                            </div>

                                        </div>
                                    </div>
                                    <div class="reaction-hover">
                                        <div>
                                            <img (click)="this.addReaction(currentUser, message, 'reactionNerd')" src="./assets/icons/emoji _nerd face_.png" alt="">
                                            <img (click)="this.addReaction(currentUser, message, 'reactionCelebrate')" src="./assets/icons/emoji _person raising both hands in celebration_.png"alt="">
                                            <img (click)="this.addReaction(currentUser, message, 'reactionCheck')" src="./assets/icons/emoji _white heavy check mark_.png" alt="">
                                            <img (click)="this.addReaction(currentUser, message, 'reactionRocket')" src="./assets/icons/emoji _rocket_.png" alt="">
                                            <img src="./assets/icons/add_reaction.png" alt="">
                                            <img src="./assets/icons/comment.png" alt="">
                                        </div>

                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Nachricht des aktuellen Benutzers -->
                    <div *ngIf="message.senderId == currentUser.userId">
                        <table class="chat-table-sender">
                            <tr>
                                <td>
                                    <div class="reaction-hover" *ngIf="editingMessageId !== message.messageId">
                                        <img (click)="this.addReaction(currentUser, message, 'reactionNerd')" src="./assets/icons/emoji _nerd face_.png" alt="">
                                        <img (click)="this.addReaction(currentUser, message, 'reactionCelebrate')" src="./assets/icons/emoji _person raising both hands in celebration_.png"alt="">
                                        <img (click)="this.addReaction(currentUser, message, 'reactionCheck')" src="./assets/icons/emoji _white heavy check mark_.png" alt="">
                                        <img (click)="this.addReaction(currentUser, message, 'reactionRocket')" src="./assets/icons/emoji _rocket_.png" alt="">

                                        <img src="./assets/icons/more_vert.png" alt=""
                                            (click)="editDirectMessage(message)">
                                    </div>

                                    <div class="message-main">
                                        <div class="message-content" *ngIf="editingMessageId !== message.messageId">
                                            <div class="name-time">
                                                <p class="time">{{ message.time }} Uhr</p> {{ currentUser.name }}
                                            </div>
                                            <div class="speech-bubble">
                                                <span>{{ message.text }}</span>

                                                <div *ngIf="message.fileName" class="file-container">
                                                    <span>{{message.fileName}}</span>

                                                    <img *ngIf="message.fileType == 'image/jpeg' || message.fileType == 'image/png'" class="preview-img" [src]="message.fileDownloadUrl" alt="">

                                                    <object *ngIf="message.fileType == 'application/pdf'" [data]="message.safeUrl" type="application/pdf" width="60%" height="100%">
                                                        Dein Browser unterstützt keine PDF-Anzeige
                                                    </object>

                                                    <pre *ngIf="message.fileType == 'text/plain'" style="overflow: auto;"> <p>{{this.chatService.textContent}}</p></pre>

                                                    <button class="open-file-button" (click)="downloadFile(message.fileDownloadUrl, message.fileName)">
                                                        Anhang öffnen
                                                    </button>
                                                </div>
                                            </div>

                                            <div class="reaction-container">
                                                <div *ngIf="message.reactionNerd && message.reactionNerd.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionNerd')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionNerd')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _nerd face_.png" alt="">
                                                        <span>{{message.reactionNerd.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble"                                                        
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionNerd'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionNerd') 
                                                      }">
                                                            <img src="./assets/icons/emoji _nerd face_.png" alt="">
                                                            @for (user of message.reactionNerd; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionNerd.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionNerd.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionNerd.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionNerd.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <div *ngIf="message.reactionCelebrate && message.reactionCelebrate.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionCelebrate')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionCelebrate')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _person raising both hands in celebration_.png" alt="">
                                                        <span>{{message.reactionCelebrate.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble"
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionCelebrate'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionCelebrate') 
                                                      }">
                                                            <img src="./assets/icons/emoji _person raising both hands in celebration_.png" alt="">
                                                            
                                                            @for (user of message.reactionCelebrate; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionCelebrate.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionCelebrate.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionCelebrate.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionCelebrate.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <div *ngIf="message.reactionCheck && message.reactionCheck.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionCheck')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionCheck')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _white heavy check mark_.png" alt="">
                                                        <span>{{message.reactionCheck.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble"
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionCheck'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionCheck') 
                                                      }">
                                                            <img src="./assets/icons/emoji _white heavy check mark_.png" alt="">
                                                            
                                                            @for (user of message.reactionCheck; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionCheck.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionCheck.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionCheck.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionCheck.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <div *ngIf="message.reactionRocket && message.reactionRocket.length > 0" style="position: relative;">
                                                    <button class="reaction-button" 
                                                    (click)="this.addReaction(currentUser, message, 'reactionRocket')"
                                                    (mouseenter)="isHovered(message.messageId, 'reactionRocket')" 
                                                    (mouseleave)="isHovered(null, null)">
                                                        <img src="./assets/icons/emoji _rocket_.png" alt="">
                                                        <span>{{message.reactionRocket.length}}</span>
                                                    </button>
    
                                                    <div class="reaction-bubble"
                                                    [ngClass]="{ 
                                                        'visible': isBubbleVisible(message.messageId, 'reactionRocket'), 
                                                        'hidden': !isBubbleVisible(message.messageId, 'reactionRocket') 
                                                      }">
                                                            <img src="./assets/icons/emoji _rocket_.png" alt="">
                                                            
                                                            @for (user of message.reactionRocket; track $index) {
                                                                
                                                                @if(user.name !== currentUser.name) {
                                                                    <span class="header5">{{user.name}}</span>
                                                                    @if(user.name !== currentUser.name && message.reactionRocket.length == 1){
                                                                        <span>hat reagiert</span>
                                                                    }
                                                                }
                                                                @else if(user.name == currentUser.name){
                                                                    @if(message.reactionRocket.length == 2){
                                                                        <span class="header5">und</span>
                                                                    }
                                                                    <span class="header5">Du</span>
                                                                    @if(user.name == currentUser.name && message.reactionRocket.length == 1){
                                                                        <span>hast reagiert</span>
                                                                    }
                                                                    @if(message.reactionRocket.length == 2){
                                                                        <span>haben reagiert</span>
                                                                    }
                                                                }
                                                            }
                                                    </div>
                                                </div>

                                                <button class="add-reaction-button">
                                                    <img src="./assets/icons/add_reaction.png" alt="">
                                                </button>
                                            </div>
                                        </div>


                                        <div *ngIf="editingMessageId === message.messageId"
                                            class="edit-message-container">

                                            <textarea class="edit-textarea" [formControl]="editedMessage"></textarea>
                                            <div *ngIf="message.fileName" class="file-container">
                                                <span>{{message.fileName}}</span>

                                                <img *ngIf="message.fileType == 'image/jpeg' || message.fileType == 'image/png'" class="preview-img" [src]="message.fileDownloadUrl" alt="">

                                                <object *ngIf="message.fileType == 'application/pdf'" [data]="message.safeUrl" type="application/pdf" width="60%" height="100%">
                                                    Dein Browser unterstützt keine PDF-Anzeige
                                                </object>

                                                <pre *ngIf="message.fileType == 'text/plain'" style="overflow: auto;"> <p>{{this.chatService.textContent}}</p></pre>
                                            </div>
                                            <div class="bottom-container">
                                                <div class="reactions">
                                                    <img src="./assets/icons/sentiment_satisfied-1.png" alt=""
                                                        class="add-emoji">
                                                </div>

                                                <div class="button-container">
                                                    <button class="cancel-button" (click)="cancelEditing()">
                                                        Abbrechen
                                                    </button>
                                                    <button class="save-button"
                                                        (click)="setEditedDirectMessage(message)"
                                                        [disabled]="editedMessage.invalid">
                                                        Speichern
                                                    </button>
                                                </div>

                                            </div>


                                        </div>
                                        <img class="avatar" [src]="getAvatarForUser(currentUser.name)"
                                        alt="">
                                    </div>

                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Wenn keine Nachrichten vorhanden sind -->
    <div class="new-chat-info-container" *ngIf="chatService.chatIsEmpty">
        <div class="new-chat-user-avatar-container">
            <img class="new-chat-user-avatar" [src]="getAvatarForUser(user.name)" alt="">
            <span class="header1">{{ user.name }}
                @if (user.name === currentUser?.name) {
                    (Du)
                }
            </span>
        </div>

        @if (user.name === currentUser?.name) {
            <span class="info header6"><b>Dieser Raum ist nur für dich da.</b> Mache dir Notizen, liste deine To-dos auf oder 
                bewahre Links und Dateien griffbereit auf.
                Du kannst hier auch gerne Dinge mit dir selbst besprechen.
            </span>
        } @else {
            <span class="info header6">Diese Unterhaltung findet nur zwischen <span class="name-colored">&#64;{{ user.name }}</span> und dir statt.</span>
        }

    </div>

    <!-- Nachrichteneingabe -->
    <div class="custom-input">

        
        <textarea contenteditable="true" placeholder="Nachricht an {{ user.name }}" class="text-area" [formControl]="directMessage"></textarea>
        <div *ngIf="hasNames" class="name-container" #nameContainerRef>
            CC:
            <div *ngFor="let name of selectedNames, let i = index" class="name-tag">
                <div class="close-name-tag" (click)="removeName(i)">
                    <img src="../../../assets/icons/close-white.svg" alt="">
                </div>
                &#64;{{ name.name }}
            </div>
          </div>


        @if (selectedFile) { <!-- Datei-Anzeige -->
        <div class="file-upload-container">

            <img *ngIf="this.selectedFileType == 'image/jpeg' || this.selectedFileType  == 'image/png'" style="height: 60px; width: 40%;object-fit: contain;" [src]="fileDownloadUrl" alt="">

            <iframe *ngIf="this.selectedFileType == 'application/pdf' && safeUrl" [src]="this.safeUrl" type="application/pdf" width="40%" height="60px">
                Dein Browser unterstützt keine PDF-Anzeige
            </iframe>

            <pre *ngIf="this.selectedFileType  == 'text/plain'" style="overflow: auto;"> 
                <p>{{this.chatService.textContent}}</p>
            </pre>

            <span> {{ selectedFileName }}</span>
            <label for="file-change" style="height: 24px;">
                <img class="file-button-change" src="./assets/icons/edit.png" alt="Anhang ändern">
            </label>

            <input style="display: none;" id="file-change" type="file"
            (change)="onChangeFileSelected($event, selectedFileName)" />
            
            <img class="file-button-delete" (click)="deleteFile(selectedFileName); selectedFile = null;" 
            src="./assets/icons/close.png" alt="Anhang löschen">

        </div>
        }

        <div class="add-reaction">
            <div class="reactions">

                <div class="upload-area"> <!-- Datei-Upload -->
                    <label for="file-upload">
                        <img src="./assets/icons/add-1.png" alt="" class="add-icon">
                    </label>

                    <input style="display: none;" id="file-upload" type="file" (change)="onFileSelected($event)" />
                </div>


                <div style="height: 50px; width: 1px; background-color: rgba(104, 104, 104, 1);"></div>
                <div>
                    <img src="./assets/icons/sentiment_satisfied-1.png" (click)="toogleEmojis()" alt="" class="add-emoji">
             
                    <emoji-mart *ngIf="showEmojis"
                      set="google"
                      
                      [emojiSize]="24"
                      (emojiSelect)="onEmojiSelect($event)">
                    </emoji-mart>
                </div>

              
                
                <img src="./assets/icons/alternate_email-1.png" (click)="toggleUserList()" alt="" class="add-mail">

            </div>
            @if (showUsers) {
                <div class="users-dialog">
                    @for (user of userList; track user.name) {
                        <div class="user-item" (click)="insertName(user.name)">
                            <img class="further-user-avatar" [src]="userService.getAvatarForUser(user.name)" alt="{{ user.name }}">
                            <span class="user-name">{{ user.name }}</span>
                        </div>
                    }
                </div>
            }

            <button (click)="sendDirectMessage(); 
            selectedFile = null; 
            this.selectedFileName = ''; 
            this.fileDownloadUrl=''" 
            [disabled]="directMessage.invalid && !selectedFile">
                <img src="./assets/icons/Send icon.png">
            </button>
        </div>
    </div>
</div>